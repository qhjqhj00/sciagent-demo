<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Research Paper Search</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="header">
      <h1 class="title">AI Research Hub</h1>
      <p class="slogan">Discover cutting-edge research in one place</p>
    </header>

    <!-- Data Status Bar -->
    <div class="status-bar" v-if="stats">
      <div class="status-item">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M8 0L1 3v5c0 4.3 3.5 7.8 7 8v-3H3V6l5-2v8c4-.2 7-3 7-7V3L8 0z" fill="currentColor"/>
        </svg>
        <span class="status-label">Total Papers:</span>
        <span class="status-value">{{ stats.total_papers.toLocaleString() }}</span>
      </div>
      <div class="status-item">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm1 11H7V7h2v4zM8 6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1-.4 1-1 1z" fill="currentColor"/>
        </svg>
        <span class="status-label">Latest Update:</span>
        <span class="status-value">{{ stats.latest_update }}</span>
      </div>
    </div>

    <!-- Search Section -->
    <section class="search-section">
      <div class="search-container">
        <div class="search-row">
          <div class="search-box">
            <input 
              type="text" 
              v-model="searchQuery" 
              @keyup.enter="handleSearch"
              placeholder="Search for papers, authors, topics..."
              class="search-input"
            />
            <button @click="handleSearch" class="search-button" title="Search">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="m19 19-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
          <button @click="clearSearch" class="clear-button" title="Clear">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13.5 4.5l-9 9M4.5 4.5l9 9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>

        <!-- Search Parameters -->
        <div class="search-parameters">
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                v-model="queryUnderstanding"
                class="checkbox-input"
              />
              Query Understanding
            </label>
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                v-model="smartRerank"
                class="checkbox-input"
              />
              Smart Rerank
            </label>
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                v-model="useCache"
                class="checkbox-input"
              />
              Use Cache
            </label>
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                v-model="socialImpact"
                class="checkbox-input"
              />
              Social Impact
            </label>
          </div>
          <div class="divider"></div>
          <div class="select-group">
            <label class="select-label">Select Indexing Field:</label>
            <div class="custom-dropdown" @click.stop>
              <div class="dropdown-toggle" @click="toggleDropdown">
                <span class="dropdown-text">{{ selectedFieldsText }}</span>
                <svg class="dropdown-arrow" :class="{ 'open': isDropdownOpen }" width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </div>
              <div class="dropdown-menu" v-show="isDropdownOpen">
                <label 
                  v-for="option in indexingFieldOptions" 
                  :key="option.value"
                  class="dropdown-item"
                >
                  <input 
                    type="checkbox" 
                    :checked="isFieldSelected(option.value)"
                    @change="toggleField(option.value)"
                    class="dropdown-checkbox"
                  />
                  <span>{{ option.label }}</span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Recommended Queries -->
        <div class="recommended-queries">
          <span class="recommended-label">Try these:</span>
          <button 
            v-for="(query, index) in recommendedQueries" 
            :key="index"
            @click="searchWithQuery(query)"
            class="query-chip"
          >
            {{ query }}
          </button>
        </div>
      </div>
    </section>

    <!-- Loading State -->
    <section class="loading-section" v-if="hasSearched && isLoading">
      <div class="loading-container">
        <div class="spinner"></div>
        <p class="loading-text">Searching... {{ formattedTimer }}s</p>
      </div>
    </section>

    <!-- Results Section -->
    <section class="results-section" v-if="hasSearched && !isLoading && results.length > 0">
      <div class="cache-info" v-if="cacheMessage">
        <svg class="cache-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M8 2a6 6 0 0 1 6 6v1h-2V8a4 4 0 0 0-8 0v1H2V8a6 6 0 0 1 6-6z" fill="currentColor"/>
          <rect x="3" y="8" width="10" height="6" rx="1" fill="currentColor"/>
        </svg>
        <span>{{ cacheMessage }}</span>
      </div>
      <div class="results-header">
        <div class="results-info">
          <h2 class="results-title">{{ results.length }} results found</h2>
          <p class="results-subtitle" v-if="searchQuery">for "{{ searchQuery }}"</p>
        </div>
        <div class="sort-controls">
          <span class="sort-label">Sort by:</span>
          <button 
            @click="setSortBy('relevance')" 
            :class="['sort-btn', { active: sortBy === 'relevance' }]"
          >
            <svg width="14" height="14" viewBox="0 0 16 16" fill="none">
              <path d="M8 2v12M8 2l-3 3M8 2l3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Relevance
          </button>
          <button 
            @click="setSortBy('social_impact')" 
            :class="['sort-btn', { active: sortBy === 'social_impact' }]"
            :disabled="!socialImpact"
            :title="!socialImpact ? 'Enable Social Impact first' : ''"
          >
            <svg width="14" height="14" viewBox="0 0 16 16" fill="none">
              <path d="M8 1l2 4 4.5.5-3.5 3 1 4.5L8 11l-4 2 1-4.5-3.5-3L6 5l2-4z" fill="currentColor"/>
            </svg>
            Social Impact
          </button>
        </div>
      </div>

      <div class="results-container">
        <div 
          v-for="(paper, index) in paginatedResults" 
          :key="index"
          class="paper-card"
        >
          <div class="card-header">
            <span class="card-number">{{ (currentPage - 1) * itemsPerPage + index + 1 }}</span>
            <h3 class="card-title">{{ paper.title }}</h3>
          </div>

          <div class="card-content">
            <div class="card-meta-row">
              <div class="meta-item">
                <svg class="meta-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" fill="currentColor"/>
                  <path d="M2 13.5a6 6 0 0 1 12 0v.5H2v-.5z" fill="currentColor"/>
                </svg>
                <span class="card-authors">{{ paper.authors }}</span>
              </div>
            </div>

            <div class="card-meta-row" v-if="paper.orgs">
              <div class="meta-item">
                <svg class="meta-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M2 2h5v5H2V2zm0 7h5v5H2V9zm7-7h5v5H9V2zm0 7h5v5H9V9z" fill="currentColor"/>
                </svg>
                <span class="card-orgs">{{ paper.orgs }}</span>
              </div>
            </div>

            <div class="card-meta-row" v-if="paper.release_date">
              <div class="meta-item">
                <svg class="meta-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <rect x="2" y="3" width="12" height="11" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <path d="M2 6h12M5 1v3M11 1v3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span class="card-date">{{ paper.release_date }}</span>
              </div>
            </div>

            <div class="social-impact-badge" v-if="paper.social_score !== null && paper.social_score !== undefined">
              <div class="social-impact-label">
                <svg class="social-icon" width="14" height="14" viewBox="0 0 16 16" fill="none">
                  <path d="M8 1l2 4 4.5.5-3.5 3 1 4.5L8 11l-4 2 1-4.5-3.5-3L6 5l2-4z" fill="currentColor"/>
                </svg>
                <span>Social Impact</span>
              </div>
              <div class="social-impact-bar">
                <div 
                  class="social-impact-fill" 
                  :style="{
                    width: paper.social_score + '%',
                    background: getSocialColor(paper.social_score)
                  }"
                ></div>
                <span class="social-impact-score">{{ paper.social_score }}</span>
              </div>
            </div>

            <div class="card-abstract">
              <p>{{ paper.abs }}</p>
            </div>

            <div class="card-footer">
              <div class="meta-info">
                <svg class="meta-icon-small" width="14" height="14" viewBox="0 0 16 16" fill="none">
                  <path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm1 11H7V7h2v4zM8 6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1-.4 1-1 1z" fill="currentColor"/>
                </svg>
                <span>{{ paper.meta }}</span>
              </div>
              <a :href="paper.url" target="_blank" class="card-link">
                View Paper
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                  <path d="M13 1L5 9M13 1h-4M13 1v4m0-4L7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Pagination -->
      <div class="pagination" v-if="hasSearched && results.length > itemsPerPage">
        <button @click="prevPage" :disabled="currentPage === 1" class="page-btn">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M10 12L6 8l4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Previous
        </button>
        
        <div class="page-numbers">
          <button 
            v-for="page in totalPages" 
            :key="page"
            @click="goToPage(page)"
            :class="['page-number', { active: currentPage === page }]"
          >
            {{ page }}
          </button>
        </div>
        
        <button @click="nextPage" :disabled="currentPage === totalPages" class="page-btn">
          Next
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M6 12l4-4-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </section>

    <!-- Empty State -->
    <section class="empty-state" v-if="!hasSearched">
      <div class="empty-icon">ðŸ“š</div>
      <h3>Start Your Research Journey</h3>
      <p>Search for research papers, explore authors, or discover new topics.</p>
    </section>
  </div>

  <script src="app.js"></script>
</body>
</html>